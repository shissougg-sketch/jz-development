---
interface Props {
  title: string;
  description: string;
  href: string;
  icon?: string;
  image?: string;
  compact?: boolean;
}

const { title, description, href, icon = 'hammer', image, compact = false } = Astro.props;

// Local service images mapped to icon types
const serviceImages: Record<string, { webp: string; png: string }> = {
  renovation: { webp: '/images/Services/one.webp', png: '/images/Services/one.png' },
  kitchen: { webp: '/images/Services/two.webp', png: '/images/Services/two.png' },
  brick: { webp: '/images/Services/three.webp', png: '/images/Services/three.png' },
  exterior: { webp: '/images/Services/four.webp', png: '/images/Services/four.png' },
  foundation: { webp: '/images/Services/five.webp', png: '/images/Services/five.png' },
  epoxy: { webp: '/images/Services/six.webp', png: '/images/Services/six.png' },
  construction: { webp: '/images/Services/seven.webp', png: '/images/Services/seven.png' },
  maintenance: { webp: '/images/Services/eight.webp', png: '/images/Services/eight.png' },
};

// Get image paths - use provided image or fall back to service images
const getImagePaths = () => {
  if (image) {
    // If image is provided, derive PNG fallback from WebP path
    const pngPath = image.replace('.webp', '.png');
    return { webp: image, png: pngPath };
  }
  return serviceImages[icon] || serviceImages.renovation;
};

const imagePaths = getImagePaths();
---

{compact ? (
  <!-- Compact card style (matches featured projects) -->
  <a
    href={href}
    class="group relative aspect-square rounded-xl overflow-hidden shadow-lg card-hover card-glow block"
  >
    <picture>
      <source srcset={imagePaths.webp} type="image/webp" />
      <img
        src={imagePaths.png}
        alt={title}
        class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500"
        loading="lazy"
      />
    </picture>
    <!-- Gradient overlay -->
    <div class="absolute inset-0 bg-gradient-to-t from-[var(--charcoal)] via-[var(--charcoal)]/20 to-transparent opacity-60 group-hover:opacity-80 transition-opacity duration-300"></div>
    <!-- Content always visible -->
    <div class="absolute bottom-0 left-0 right-0 p-3 md:p-4">
      <p class="text-white font-bold text-sm md:text-base leading-tight">{title}</p>
    </div>
    <!-- Learn more indicator on hover -->
    <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
      <span class="px-3 py-1.5 md:px-4 md:py-2 bg-[var(--secondary)] text-white text-sm font-semibold rounded-lg transform -translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
        Learn More
      </span>
    </div>
  </a>
) : (
  <!-- Full card style -->
  <a
    href={href}
    class="group block bg-white rounded-xl shadow-md hover:shadow-2xl transition-all duration-300 overflow-hidden border border-gray-100 hover:border-[var(--secondary)] card-hover card-glow"
  >
    <!-- Image with overlay -->
    <div class="relative aspect-video overflow-hidden">
      <picture>
        <source srcset={imagePaths.webp} type="image/webp" />
        <img
          src={imagePaths.png}
          alt={title}
          class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500"
          loading="lazy"
        />
      </picture>
      <!-- Gradient overlay -->
      <div class="absolute inset-0 bg-gradient-to-t from-[var(--charcoal)]/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
      <!-- Icon badge -->
      <div class="absolute top-4 right-4 w-12 h-12 bg-white/90 backdrop-blur-sm rounded-xl flex items-center justify-center shadow-lg transform group-hover:scale-110 transition-transform">
      {icon === 'hammer' && (
        <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
        </svg>
      )}
      {icon === 'brick' && (
        <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z" />
        </svg>
      )}
      {icon === 'foundation' && (
        <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
        </svg>
      )}
      {icon === 'renovation' && (
        <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z" />
        </svg>
      )}
      {icon === 'kitchen' && (
        <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
      )}
      {icon === 'epoxy' && (
        <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
        </svg>
      )}
      {icon === 'exterior' && (
        <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
      )}
      {icon === 'construction' && (
        <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
        </svg>
      )}
      {icon === 'waterproofing' && (
        <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
      )}
      {icon === 'maintenance' && (
        <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437" />
        </svg>
      )}
    </div>
  </div>

  <div class="p-6">
    <h3 class="text-lg font-bold text-[var(--charcoal)] mb-2 group-hover:text-[var(--primary)] transition-colors">
      {title}
    </h3>
    <p class="text-sm text-gray-600 mb-4 line-clamp-2">
      {description}
    </p>
    <span class="inline-flex items-center text-sm font-semibold text-[var(--primary)] group-hover:text-[var(--secondary)] transition-colors">
      Learn More
      <svg class="w-4 h-4 ml-1 group-hover:translate-x-2 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
      </svg>
    </span>
  </div>
  </a>
)}
